<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>check.js - Docdash</title>
    
    <meta name="description" content="A clean, responsive documentation template theme for JSDoc 3." />
    
        <meta name="keywords" content="jsdoc, docdash" />
        <meta name="keyword" content="jsdoc, docdash" />
    
    
    
    <meta property="og:title" content="Docdash"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://cloud.githubusercontent.com/assets/447956/13398144/4dde7f36-defd-11e5-8909-1a9013302cb9.png"/>
    <meta property="og:site_name" content="Docdash"/>
    <meta property="og:url" content="http://clenemt.github.io/docdash/"/>
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    <input type="text" id="nav-search" placeholder="Search" />
    
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Check.html">Check</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Check.html#then">then</a></li></ul></li><li><a href="Clock.html">Clock</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Clock.html#close">close</a></li><li data-type='method' style='display: none;'><a href="Clock.html#onStatusChange">onStatusChange</a></li><li data-type='method' style='display: none;'><a href="Clock.html#pause">pause</a></li><li data-type='method' style='display: none;'><a href="Clock.html#reInit">reInit</a></li><li data-type='method' style='display: none;'><a href="Clock.html#restart">restart</a></li><li data-type='method' style='display: none;'><a href="Clock.html#start">start</a></li></ul></li><li><a href="InnerAudio.html">InnerAudio</a><ul class='methods'><li data-type='method' style='display: none;'><a href="InnerAudio.html#onStatusChange">onStatusChange</a></li><li data-type='method' style='display: none;'><a href="InnerAudio.html#play">play</a></li><li data-type='method' style='display: none;'><a href="InnerAudio.html#setSrc">setSrc</a></li><li data-type='method' style='display: none;'><a href="InnerAudio.html#stop">stop</a></li></ul></li><li><a href="Memento.html">Memento</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Memento.html#backup">backup</a></li><li data-type='method' style='display: none;'><a href="Memento.html#clear">clear</a></li><li data-type='method' style='display: none;'><a href="Memento.html#getState">getState</a></li><li data-type='method' style='display: none;'><a href="Memento.html#restore">restore</a></li></ul></li><li><a href="MSocket.html">MSocket</a><ul class='methods'><li data-type='method' style='display: none;'><a href="MSocket.html#close">close</a></li><li data-type='method' style='display: none;'><a href="MSocket.html#connect">connect</a></li><li data-type='method' style='display: none;'><a href="MSocket.html#onMessage">onMessage</a></li><li data-type='method' style='display: none;'><a href="MSocket.html#reconnect">reconnect</a></li><li data-type='method' style='display: none;'><a href="MSocket.html#send">send</a></li></ul></li><li><a href="RecorderManager.html">RecorderManager</a><ul class='methods'><li data-type='method' style='display: none;'><a href="RecorderManager.html#onStatusChange">onStatusChange</a></li><li data-type='method' style='display: none;'><a href="RecorderManager.html#start">start</a></li><li data-type='method' style='display: none;'><a href="RecorderManager.html#stop">stop</a></li></ul></li></ul><h3>Modules</h3><ul><li><a href="module-axios-mock-adapter.html">axios-mock-adapter</a></li><li><a href="module-AxiosPlugin.html">AxiosPlugin</a></li><li><a href="module-camel.html">camel</a></li><li><a href="module-canvas.html">canvas</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-canvas.html#~drawRoundRectPath">drawRoundRectPath</a></li><li data-type='method' style='display: none;'><a href="module-canvas.html#~fillRoundRect">fillRoundRect</a></li></ul></li><li><a href="module-filter.html">filter</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-filter.html#~dateTime%25E6%2597%25B6%25E9%2597%25B4%25E6%2588%25B3%25E8%25BD%25AC%25E6%2597%25A5%25E6%259C%259F">dateTime 时间戳转日期</a></li><li data-type='method' style='display: none;'><a href="module-filter.html#~divide%25E5%2588%2586%25E9%259A%2594%25E6%2595%25B0%25E5%25AD%2597">divide 分隔数字</a></li><li data-type='method' style='display: none;'><a href="module-filter.html#~fmoney%25E8%25B4%25A7%25E5%25B8%2581%25E6%25A0%25BC%25E5%25BC%258F%25E5%258C%2596">fmoney 货币格式化</a></li><li data-type='method' style='display: none;'><a href="module-filter.html#~maps%25E7%25A0%2581%25E8%25A1%25A8">maps 码表</a></li><li data-type='method' style='display: none;'><a href="module-filter.html#~percentage%25E7%2599%25BE%25E5%2588%2586%25E5%258C%2596">percentage 百分化</a></li><li data-type='method' style='display: none;'><a href="module-filter.html#~signature%25E6%25AD%25A3%25E8%25B4%259F%25E7%25AC%25A6%25E5%258F%25B7">signature 正负符号</a></li><li data-type='method' style='display: none;'><a href="module-filter.html#~suffix%25E5%2589%258D%25E5%2590%258E%25E7%25BC%2580">suffix 前后缀</a></li><li data-type='method' style='display: none;'><a href="module-filter.html#~thousands%25E5%258D%2583%25E5%2588%2586%25E4%25BD%258D">thousands 千分位</a></li><li data-type='method' style='display: none;'><a href="module-filter.html#~W%25E4%25B8%2587">W 万</a></li></ul></li><li><a href="module-flexible.html">flexible</a></li><li><a href="module-libs.html">libs</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-libs.html#~calcAge%25E8%25AE%25A1%25E7%25AE%2597%25E5%25B9%25B4%25E9%25BE%2584">calcAge 计算年龄</a></li><li data-type='method' style='display: none;'><a href="module-libs.html#~checkVin%25E8%25BD%25A6%25E6%259E%25B6%25E5%258F%25B7%25E6%25A0%25A1%25E9%25AA%258C">checkVin 车架号校验</a></li><li data-type='method' style='display: none;'><a href="module-libs.html#~fmoney%25E9%2587%2591%25E9%25A2%259D%25E6%25A0%25BC%25E5%25BC%258F%25E5%258C%2596">fmoney 金额格式化</a></li><li data-type='method' style='display: none;'><a href="module-libs.html#~formatDate%25E6%25A0%25BC%25E5%25BC%258F%25E5%258C%2596%25E6%2597%25B6%25E9%2597%25B4">formatDate 格式化时间</a></li><li data-type='method' style='display: none;'><a href="module-libs.html#~getDistance%25E8%25AE%25A1%25E7%25AE%2597%25E4%25B8%25A4%25E7%2582%25B9%25E8%25B7%259D%25E7%25A6%25BB">getDistance 计算两点距离</a></li><li data-type='method' style='display: none;'><a href="module-libs.html#~sleep%25E7%25AD%2589%25E5%25BE%2585">sleep 等待</a></li><li data-type='method' style='display: none;'><a href="module-libs.html#~timeDiff%25E8%25AE%25A1%25E7%25AE%2597%25E6%2597%25B6%25E5%25B7%25AE">timeDiff 计算时差</a></li></ul></li><li><a href="module-P_A.html">P_A</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-P_A.html#~popWebview">popWebview</a></li><li data-type='method' style='display: none;'><a href="module-P_A.html#~shareImg%25E5%2588%2586%25E4%25BA%25AB%25E5%259B%25BE%25E7%2589%2587">shareImg 分享图片</a></li></ul></li><li><a href="module-public.html">public</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-public.html#~Connect%25E8%25BF%259E%25E6%258E%25A5%25E8%25BF%259C%25E7%25A8%258B%25E7%2594%25B5%25E8%2584%2591">Connect 连接远程电脑</a></li><li data-type='method' style='display: none;'><a href="module-public.html#~Shell%25E8%25BF%2590%25E8%25A1%258Cshell%25E5%2591%25BD%25E4%25BB%25A4">Shell 运行shell命令</a></li><li data-type='method' style='display: none;'><a href="module-public.html#~UploadFile%25E4%25B8%258A%25E4%25BC%25A0%25E6%2596%2587%25E4%25BB%25B6">UploadFile 上传文件</a></li></ul></li><li><a href="module-wepp.html">wepp</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-wepp.html#~bs64Tofilebase64%25E8%25BD%25AC%25E6%2596%2587%25E4%25BB%25B6">bs64Tofile base64转文件</a></li><li data-type='method' style='display: none;'><a href="module-wepp.html#~chooseImageByCapture">chooseImageByCapture</a></li><li data-type='method' style='display: none;'><a href="module-wepp.html#~chooseImageFromAlbum">chooseImageFromAlbum</a></li><li data-type='method' style='display: none;'><a href="module-wepp.html#~imgTobs64%25E5%259B%25BE%25E7%2589%2587%25E8%25BD%25ACbase64">imgTobs64 图片转base64</a></li><li data-type='method' style='display: none;'><a href="module-wepp.html#~saveFile%25E4%25BF%259D%25E5%25AD%2598%25E4%25B8%25B4%25E6%2597%25B6%25E6%2596%2587%25E4%25BB%25B6">saveFile 保存临时文件</a></li><li data-type='method' style='display: none;'><a href="module-wepp.html#~saveImageToPhotosAlbum%25E4%25BF%259D%25E5%25AD%2598%25E5%2588%25B0%25E7%259B%25B8%25E5%2586%258C">saveImageToPhotosAlbum 保存到相册</a></li></ul></li></ul><h3>Tutorials</h3><ul><li><a href="tutorial-camel.html">camel模块使用教程</a></li><li><a href="tutorial-css.html">css代码库</a></li><li><a href="tutorial-designMode.html">设计模式</a></li><li><a href="tutorial-vue.html">vue 教程</a></li><li><a href="tutorial-weapp.html">小程序开发技巧致</a></li><li><a href="tutorial-webpack.prod.conf.html">webpack 生产配置</a></li><li><a href="tutorial-wechat.html">微信开发教程</a></li></ul><h3>Global</h3><ul><li><a href="global.html#RegEx">RegEx</a></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">check.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>// 校验类型
const checkType = {
  NotNull: /\S+/,
  NameC: /^[\u4E00-\u9FA5]+$/,
  NameE: /^[A-Za-z\s]+$/,
  Email: /^[A-Za-z\d]+([-_.][A-Za-z\d]+)*@([A-Za-z\d]+[-.])+[A-Za-z\d]{2,4}$/,
  TelePhone: /^[0-9]*$/
}

// 遍历对象
function each (obj, callback) {
  for (let i in obj) {
    if (callback.call(obj[i], i, obj[i]) === false) {
      break
    }
  }
}

// 单个检验
// Param item string 被检验值
// Param auth 测试对象
function checkItem (item, auth) {
  let reg = checkType[auth] || auth
  let type = toString.call(reg)
  if ((type === '[object Function]') || (type === '[object Object]')) {
    return reg(item)
  }
  if (item !== undefined &amp;&amp; reg.test(item)) {
    return true
  }
  return false
}

/**
 * @class Check
 * @param {object} obj - 被校验对象
 * @param {object} props - 校验规则
 * @param {boolean} [isContinue = false] - 遇到错误后是否继续
 * @desc 数据校验类
 * @author xiedrsz
 * @since 2018.09.04
 */
class Check {
  constructor (obj, props, isContinue = false) {
    /**
     * @member {Array.&lt;{label: string, msg: string}>}
     * @desc 消息列表
     */
    this.msgList = []
    this.flag = true
    let auth, messList, i, len, msg
    let self = this
    let checkObj = (obj, props, isContinue, index) => {
      each(props, (label, value) => {
        auth = value.auth
        messList = value.mess || [false]
        // 遇到对象数组
        if (toString.call(value) === '[object Array]') {
          let propArr = value[0]
          obj[label].forEach((item, index) => {
            checkObj(item, propArr, isContinue, index)
          })
          return true
        }

        // 正常情况
        len = auth.length
        for (i = 0; i &lt; len; i++) {
          if (!checkItem(obj[label], auth[i])) {
            self.message = msg = (index !== undefined ? `${index}-` : '') + messList[i] || messList[0]
            self.msgList.push({label, msg})
            self.flag = false
            return isContinue
          }
        }
      })
    }
    checkObj(obj, props, isContinue)
  }

  /**
   * @desc 回调
   * @param {function} func - 错误处理函数.
   * @returns {(undefined|boolean)} 有错误则返回undefined, 没错误则返回 true
   */
  then (func) {
    if (!this.flag) {
      this.msgList.forEach(message => {
        func(message)
      })
    }
    return this.flag
  }
}

export {
  Check,
  checkType
}
</code></pre>
        </article>
    </section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>

<script src="scripts/search.js" defer></script>


<script src="scripts/collapse.js" defer></script>


</body>
</html>
